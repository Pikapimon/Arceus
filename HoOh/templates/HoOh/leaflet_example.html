<!DOCTYPE HTML>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <script src="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.js"></script>
    <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.css" />
    {% load static %}
    <script type="text/javascript" src = '  {% static "HoOh/geodata.js" %}   '></script>

    {% load static %}
    <link rel="stylesheet" href='{% static "HoOh/leafutil.css" %}'>
    <script type="text/javascript" src='{% static "HoOh/draw_china.js" %}'></script>
    
  </head>
  <body>
    <div id="map"></div>
  </body>
  <script>
var mapboxAccessToken = 'pk.eyJ1IjoicGlrYW1vbjExMSIsImEiOiJja3NhZXdxdGkwcTJmMnVxcDYxeHdpNHAzIn0.y9FYPXxUqaLhNRjghWjKkA';
var map = L.map('map').setView([30, 100], 4);
// L.mapbox.tileLayer('mapbox.satellite').addTo(map);
L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token=' + mapboxAccessToken, {
    id: 'mapbox/light-v9',
    attribution:'Imagery &copy <a href="https://www.mapbox.com/">Mapbox</a>', 
    tileSize: 512,
    zoomOffset: -1
}).addTo(map);
var geojson;
geojson = L.geoJson(statesData,{
	style:style,
	onEachFeature: onEachFeature
}).addTo(map);
L.marker({lon: 140, lat: 30}).bindPopup('<span style="font-size:15px;">Fill your <span class="bdtxt">data</span> here in precise <span class="bdtxt">Lon&Lat</span></span>').addTo(map);

//Custom Info Control
var info = L.control();
info.onAdd = function (map) {
    this._div = L.DomUtil.create('div', 'info'); // create a div with a class "info"
    this.update();
    return this._div;
};
// method that we will use to update the control based on feature properties passed
info.update = function (props) {
    this._div.innerHTML = '<h4>CN city chilren number</h4>' +  (props ?
        '<b>' + props.name + '</b><br />管辖' + props.childrenNum + ' 个地级市'
        : 'Hover over a province');
};
info.addTo(map);

//test
var mapstyle = L.control();
mapstyle.onAdd = function(map){
    this._div = L.DomUtil.create('div','switcher');
    this._div.innerHTML = "<h4>Switch map style</h4><button onclick=changeStyle('light')>light</button><button onclick=changeStyle('dark')>dark</button><button onclick=changeStyle('satellite')>satellite</button>";
    return this._div;
};
mapstyle.addTo(map);
//legend
var legend = L.control({position: 'bottomright'});

legend.onAdd = function (map) {

    var div = L.DomUtil.create('div', 'info legend'),
        grades = [0, 2, 4, 6, 8, 10, 12, 14,16,18],
        labels = [];

    // loop through our density intervals and generate a label with a colored square for each interval
    for (var i = 0; i < grades.length; i++) {
        div.innerHTML +=
            '<i style="background:' + getColor(grades[i] + 1) + '"></i> ' +
            grades[i] + (grades[i + 1] ? '&ndash;' + grades[i + 1] + '<br>' : '+');
    }

    return div;
};

legend.addTo(map);
  </script>
</html>

